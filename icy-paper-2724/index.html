<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Booking</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        #app {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            box-sizing: border-box;
        }

        h1 {
            color: #0056b3;
            text-align: center;
            margin-bottom: 25px;
        }

        .section {
            margin-bottom: 30px;
        }

        .hidden {
            display: none;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input[type="text"],
        .form-group input[type="datetime-local"],
        .form-group select {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background-color 0.2s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        button:active {
            background-color: #004085;
        }

        button + button {
            margin-left: 10px;
        }

        #vehicle-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .vehicle-card {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .vehicle-card img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            margin-bottom: 15px;
            object-fit: cover;
        }

        .vehicle-card h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.3em;
        }

        .vehicle-card p {
            margin: 5px 0;
            color: #555;
        }

        .vehicle-card .price {
            font-size: 1.4em;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 15px;
        }

        .vehicle-card button {
            width: 100%;
            margin-top: 15px;
        }

        #booking-summary {
            background-color: #e9f7ee;
            border: 1px solid #d4edda;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
        }

        #booking-summary p {
            margin: 10px 0;
            line-height: 1.6;
        }

        #booking-summary strong {
            color: #0056b3;
        }

        .error-msg {
            color: #dc3545;
            margin-top: 10px;
            font-size: 0.9em;
            text-align: center;
        }

        #final-confirmation-section {
            text-align: center;
            padding: 40px;
        }

        #final-confirmation-section h1 {
            color: #28a745;
            font-size: 2.5em;
        }

        #final-confirmation-section p {
            font-size: 1.1em;
            margin-bottom: 25px;
        }

        @media (max-width: 600px) {
            #app {
                padding: 20px;
            }

            .form-group input[type="text"],
            .form-group input[type="datetime-local"],
            .form-group select {
                width: 100%;
            }

            button {
                width: 100%;
                margin-left: 0;
                margin-top: 10px;
            }

            button + button {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="search-section" class="section">
            <h1>Book Your Vehicle</h1>
            <div class="form-group">
                <label for="vehicle-type">Vehicle Type:</label>
                <select id="vehicle-type">
                    <option value="">Any</option>
                    <option value="Sedan">Sedan</option>
                    <option value="SUV">SUV</option>
                    <option value="Truck">Truck</option>
                </select>
            </div>
            <div class="form-group">
                <label for="pickup-location">Pickup Location:</label>
                <select id="pickup-location"></select>
            </div>
            <div class="form-group">
                <label for="dropoff-location">Dropoff Location:</label>
                <select id="dropoff-location"></select>
            </div>
            <div class="form-group">
                <label for="pickup-datetime">Pickup Date & Time:</label>
                <input type="datetime-local" id="pickup-datetime">
            </div>
            <div class="form-group">
                <label for="dropoff-datetime">Dropoff Date & Time:</label>
                <input type="datetime-local" id="dropoff-datetime">
            </div>
            <button id="search-btn">Search Vehicles</button>
            <p id="search-error-msg" class="error-msg"></p>
        </div>

        <div id="results-section" class="section hidden">
            <h1>Available Vehicles</h1>
            <div id="vehicle-list"></div>
            <button id="back-to-search-btn">Back to Search</button>
        </div>

        <div id="confirmation-section" class="section hidden">
            <h1>Booking Details</h1>
            <div id="booking-summary">
                <p><strong>Vehicle:</strong> <span id="conf-vehicle-model"></span> (<span id="conf-vehicle-type"></span>)</p>
                <p><strong>Pickup Location:</strong> <span id="conf-pickup-location"></span></p>
                <p><strong>Dropoff Location:</strong> <span id="conf-dropoff-location"></span></p>
                <p><strong>Pickup Time:</strong> <span id="conf-pickup-datetime"></span></p>
                <p><strong>Dropoff Time:</strong> <span id="conf-dropoff-datetime"></span></p>
                <p><strong>Price Per Day:</strong> $<span id="conf-vehicle-price"></span></p>
                <p><strong>Estimated Total:</strong> $<span id="conf-estimated-total"></span></p>
            </div>
            <button id="confirm-booking-btn">Confirm Booking</button>
            <button id="back-to-results-btn">Back to Results</button>
        </div>

        <div id="final-confirmation-section" class="section hidden">
            <h1>Booking Confirmed!</h1>
            <p>Your booking has been successfully placed.</p>
            <p>A confirmation email with details has been sent to your inbox.</p>
            <button id="new-booking-btn">Start New Booking</button>
        </div>
    </div>

    <script>
        const vehicles = [
            { id: 1, type: 'Sedan', model: 'Honda Civic', price_per_day: 50, imageUrl: 'https://via.placeholder.com/200x150/0000FF/FFFFFF?text=Civic', available: true },
            { id: 2, type: 'SUV', model: 'Toyota RAV4', price_per_day: 70, imageUrl: 'https://via.placeholder.com/200x150/FF0000/FFFFFF?text=RAV4', available: true },
            { id: 3, type: 'Truck', model: 'Ford F-150', price_per_day: 90, imageUrl: 'https://via.placeholder.com/200x150/00FF00/FFFFFF?text=F-150', available: true },
            { id: 4, type: 'Sedan', model: 'BMW 3 Series', price_per_day: 120, imageUrl: 'https://via.placeholder.com/200x150/FFFF00/000000?text=BMW+3', available: true },
            { id: 5, type: 'SUV', model: 'Jeep Grand Cherokee', price_per_day: 85, imageUrl: 'https://via.placeholder.com/200x150/00FFFF/000000?text=Grand+Cherokee', available: true },
            { id: 6, type: 'Sedan', model: 'Mercedes-Benz C-Class', price_per_day: 130, imageUrl: 'https://via.placeholder.com/200x150/FF00FF/FFFFFF?text=Mercedes+C', available: true },
            { id: 7, type: 'SUV', model: 'Nissan Rogue', price_per_day: 65, imageUrl: 'https://via.placeholder.com/200x150/800000/FFFFFF?text=Rogue', available: true },
            { id: 8, type: 'Truck', model: 'Ram 1500', price_per_day: 95, imageUrl: 'https://via.placeholder.com/200x150/008000/FFFFFF?text=Ram+1500', available: true }
        ];

        const locations = ['New York, NY', 'Los Angeles, CA', 'Chicago, IL', 'Houston, TX', 'Miami, FL', 'San Francisco, CA'];

        const sections = {
            search: document.getElementById('search-section'),
            results: document.getElementById('results-section'),
            confirmation: document.getElementById('confirmation-section'),
            final: document.getElementById('final-confirmation-section')
        };

        const vehicleTypeSelect = document.getElementById('vehicle-type');
        const pickupLocationSelect = document.getElementById('pickup-location');
        const dropoffLocationSelect = document.getElementById('dropoff-location');
        const pickupDatetimeInput = document.getElementById('pickup-datetime');
        const dropoffDatetimeInput = document.getElementById('dropoff-datetime');
        const searchBtn = document.getElementById('search-btn');
        const searchErrorMsg = document.getElementById('search-error-msg');

        const vehicleListDiv = document.getElementById('vehicle-list');
        const backToSearchBtn = document.getElementById('back-to-search-btn');

        const confVehicleModel = document.getElementById('conf-vehicle-model');
        const confVehicleType = document.getElementById('conf-vehicle-type');
        const confPickupLocation = document.getElementById('conf-pickup-location');
        const confDropoffLocation = document.getElementById('conf-dropoff-location');
        const confPickupDatetime = document.getElementById('conf-pickup-datetime');
        const confDropoffDatetime = document.getElementById('conf-dropoff-datetime');
        const confVehiclePrice = document.getElementById('conf-vehicle-price');
        const confEstimatedTotal = document.getElementById('conf-estimated-total');
        const confirmBookingBtn = document.getElementById('confirm-booking-btn');
        const backToResultsBtn = document.getElementById('back-to-results-btn');

        const newBookingBtn = document.getElementById('new-booking-btn');

        let currentBookingDetails = {};
        let lastFilteredVehicles = [];

        function showSection(sectionId) {
            for (let key in sections) {
                sections[key].classList.add('hidden');
            }
            sections[sectionId].classList.remove('hidden');
        }

        function populateLocations() {
            locations.forEach(location => {
                const option1 = document.createElement('option');
                option1.value = location;
                option1.textContent = location;
                pickupLocationSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = location;
                option2.textContent = location;
                dropoffLocationSelect.appendChild(option2);
            });
        }

        function setInitialDatetimes() {
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(now.getDate() + 1);

            const formatDateTimeLocal = (date) => {
                const year = date.getFullYear();
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const day = date.getDate().toString().padStart(2, '0');
                const hours = date.getHours().toString().padStart(2, '0');
                const minutes = date.getMinutes().toString().padStart(2, '0');
                return `${year}-${month}-${day}T${hours}:${minutes}`;
            };

            pickupDatetimeInput.value = formatDateTimeLocal(now);
            dropoffDatetimeInput.value = formatDateTimeLocal(tomorrow);
        }

        function calculateDays(pickup, dropoff) {
            const startDate = new Date(pickup);
            const endDate = new Date(dropoff);
            const diffTime = Math.abs(endDate - startDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays > 0 ? diffDays : 1; // Minimum 1 day
        }

        function renderVehicles(filteredVehs) {
            vehicleListDiv.innerHTML = '';
            if (filteredVehs.length === 0) {
                vehicleListDiv.innerHTML = '<p style="text-align: center;">No vehicles found matching your criteria.</p>';
                return;
            }

            filteredVehs.forEach(vehicle => {
                const card = document.createElement('div');
                card.classList.add('vehicle-card');
                card.innerHTML = `
                    <img src="${vehicle.imageUrl}" alt="${vehicle.model}">
                    <h3>${vehicle.model}</h3>
                    <p>Type: ${vehicle.type}</p>
                    <p class="price">$${vehicle.price_per_day} / day</p>
                    <button class="book-now-btn" data-vehicle-id="${vehicle.id}">Book Now</button>
                `;
                vehicleListDiv.appendChild(card);
            });

            document.querySelectorAll('.book-now-btn').forEach(button => {
                button.addEventListener('click', (event) => handleBookNow(parseInt(event.target.dataset.vehicleId)));
            });
        }

        function handleSearch() {
            searchErrorMsg.textContent = '';
            const vehicleType = vehicleTypeSelect.value;
            const pickupLocation = pickupLocationSelect.value;
            const dropoffLocation = dropoffLocationSelect.value;
            const pickupDatetime = pickupDatetimeInput.value;
            const dropoffDatetime = dropoffDatetimeInput.value;

            if (!pickupLocation || !dropoffLocation || !pickupDatetime || !dropoffDatetime) {
                searchErrorMsg.textContent = 'Please fill in all search fields.';
                return;
            }

            const pickupDate = new Date(pickupDatetime);
            const dropoffDate = new Date(dropoffDatetime);
            const now = new Date();

            if (pickupDate >= dropoffDate) {
                searchErrorMsg.textContent = 'Dropoff date/time must be after pickup date/time.';
                return;
            }
            if (pickupDate < now) {
                searchErrorMsg.textContent = 'Pickup date/time cannot be in the past.';
                return;
            }

            lastFilteredVehicles = vehicles.filter(vehicle => {
                const typeMatch = vehicleType === '' || vehicle.type === vehicleType;
                const availabilityMatch = vehicle.available; // Simulate availability
                return typeMatch && availabilityMatch;
            });

            currentBookingDetails = {
                vehicleType: vehicleType,
                pickupLocation: pickupLocation,
                dropoffLocation: dropoffLocation,
                pickupDatetime: pickupDatetime,
                dropoffDatetime: dropoffDatetime,
                pickupDateObj: pickupDate,
                dropoffDateObj: dropoffDate,
                selectedVehicle: null
            };

            renderVehicles(lastFilteredVehicles);
            showSection('results');
        }

        function handleBookNow(vehicleId) {
            const selectedVehicle = vehicles.find(v => v.id === vehicleId);
            if (!selectedVehicle) {
                alert('Selected vehicle not found.');
                return;
            }

            currentBookingDetails.selectedVehicle = selectedVehicle;
            const numDays = calculateDays(currentBookingDetails.pickupDatetime, currentBookingDetails.dropoffDatetime);
            const estimatedTotal = selectedVehicle.price_per_day * numDays;

            confVehicleModel.textContent = selectedVehicle.model;
            confVehicleType.textContent = selectedVehicle.type;
            confPickupLocation.textContent = currentBookingDetails.pickupLocation;
            confDropoffLocation.textContent = currentBookingDetails.dropoffLocation;
            confPickupDatetime.textContent = new Date(currentBookingDetails.pickupDatetime).toLocaleString();
            confDropoffDatetime.textContent = new Date(currentBookingDetails.dropoffDatetime).toLocaleString();
            confVehiclePrice.textContent = selectedVehicle.price_per_day.toFixed(2);
            confEstimatedTotal.textContent = estimatedTotal.toFixed(2);

            showSection('confirmation');
        }

        function handleConfirmBooking() {
            // In a real app, this would send data to a backend
            // For this single-file app, we just simulate success
            console.log('Booking Confirmed:', currentBookingDetails);
            showSection('final');
        }

        function handleNewBooking() {
            // Reset form
            vehicleTypeSelect.value = '';
            pickupLocationSelect.selectedIndex = 0;
            dropoffLocationSelect.selectedIndex = 0;
            setInitialDatetimes();
            searchErrorMsg.textContent = '';
            vehicleListDiv.innerHTML = '';
            currentBookingDetails = {};
            lastFilteredVehicles = [];
            showSection('search');
        }

        function handleBackToSearch() {
            showSection('search');
        }

        function handleBackToResults() {
            renderVehicles(lastFilteredVehicles); // Re-render or just show previously rendered list
            showSection('results');
        }

        // Event Listeners
        searchBtn.addEventListener('click', handleSearch);
        backToSearchBtn.addEventListener('click', handleBackToSearch);
        confirmBookingBtn.addEventListener('click', handleConfirmBooking);
        backToResultsBtn.addEventListener('click', handleBackToResults);
        newBookingBtn.addEventListener('click', handleNewBooking);

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            populateLocations();
            setInitialDatetimes();
            showSection('search');
        });
    </script>
</body>
</html>