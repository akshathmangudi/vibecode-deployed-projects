<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SteganoWeb</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hide-seek-bg {
            background-image: linear-gradient(to bottom right, #1a202c, #2d3748, #4a5568);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useRef } = React;

        function textToBinary(text) {
            return text.split('').map(char => {
                return char.charCodeAt(0).toString(2).padStart(8, '0');
            }).join('');
        }

        function binaryToText(binary) {
            let result = '';
            for (let i = 0; i < binary.length; i += 8) {
                let byte = binary.substring(i, i + 8);
                result += String.fromCharCode(parseInt(byte, 2));
            }
            return result;
        }

        function encodeMessage(imageData, message) {
            const data = imageData.data;
            const binaryMessage = textToBinary(message);
            const messageLength = binaryMessage.length;

            const lengthBinary = messageLength.toString(2).padStart(32, '0');
            const fullBinaryMessage = lengthBinary + binaryMessage;

            if (fullBinaryMessage.length > (data.length / 4) * 3) {
                throw new Error('Message too long to hide in this image. Please use a larger image or a shorter message.');
            }

            let bitIndex = 0;
            for (let i = 0; i < data.length; i++) {
                if (i % 4 < 3) {
                    if (bitIndex < fullBinaryMessage.length) {
                        const bit = parseInt(fullBinaryMessage[bitIndex], 2);
                        data[i] = (data[i] & 0xFE) | bit;
                        bitIndex++;
                    } else {
                        break;
                    }
                }
            }
            return imageData;
        }

        function decodeMessage(imageData) {
            const data = imageData.data;
            let binaryLength = '';
            let bitIndex = 0;

            for (let i = 0; i < data.length; i++) {
                if (i % 4 < 3) {
                    if (bitIndex < 32) {
                        binaryLength += (data[i] & 0x01);
                        bitIndex++;
                    } else {
                        break;
                    }
                }
            }

            const messageLength = parseInt(binaryLength, 2);
            if (isNaN(messageLength) || messageLength < 0 || messageLength > (data.length / 4) * 3 - 32) {
                return "No valid hidden message found or corrupted length. Image might not contain a message hidden by this app.";
            }

            let binaryMessage = '';
            for (let i = 0; i < data.length; i++) {
                if (i % 4 < 3) {
                    if (bitIndex < 32 + messageLength) {
                        binaryMessage += (data[i] & 0x01);
                        bitIndex++;
                    } else {
                        break;
                    }
                }
            }

            if (binaryMessage.length !== messageLength) {
                return "Incomplete message extracted. Image might be too small or corrupted.";
            }

            return binaryToText(binaryMessage);
        }

        function Navbar({ setPage }) {
            return (
                <nav className="w-full bg-gray-800 p-4 flex justify-between items-center shadow-lg">
                    <div className="text-xl font-bold text-blue-400 cursor-pointer" onClick={() => setPage('home')}>
                        SteganoWeb
                    </div>
                    <div>
                        <button onClick={() => setPage('home')} className="px-3 py-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200">
                            Home
                        </button>
                        <button onClick={() => setPage('contact')} className="ml-4 px-3 py-2 rounded-md text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200">
                            Contact Us
                        </button>
                    </div>
                </nav>
            );
        }

        function HomePage({ setPage }) {
            return (
                <div className="flex flex-col items-center justify-center flex-grow p-6">
                    <h1 className="text-5xl font-extrabold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-500 to-red-500">
                        SteganoWeb: Hide & Seek Messages in Images
                    </h1>
                    <p className="text-lg text-gray-300 max-w-2xl text-center mb-8">
                        Welcome to SteganoWeb, your online tool for steganography.
                        Seamlessly embed text messages within images or extract hidden information with ease.
                        Your digital secrets, secured and retrieved.
                    </p>
                    <button
                        onClick={() => setPage('hide-seek')}
                        className="bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out"
                    >
                        Get Started
                    </button>
                </div>
            );
        }

        function HideSeekPage({ setPage }) {
            return (
                <div className="flex flex-col items-center justify-center flex-grow p-6 hide-seek-bg text-white rounded-lg shadow-xl m-4 w-full max-w-4xl">
                    <h2 className="text-4xl font-extrabold mb-10 text-center text-blue-300">
                        Choose Your Adventure
                    </h2>
                    <div className="flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-12">
                        <button
                            onClick={() => setPage('hide')}
                            className="w-64 h-64 flex flex-col items-center justify-center bg-gray-800 hover:bg-gray-700 rounded-lg shadow-xl transform hover:scale-105 transition-all duration-300 ease-in-out border-4 border-purple-500 hover:border-purple-400"
                        >
                            <span className="text-6xl mb-4">üïµÔ∏è‚Äç‚ôÇÔ∏è</span>
                            <span className="text-3xl font-bold">Hide</span>
                            <span className="text-lg text-gray-400 mt-2">Embed a message</span>
                        </button>
                        <button
                            onClick={() => setPage('seek')}
                            className="w-64 h-64 flex flex-col items-center justify-center bg-gray-800 hover:bg-gray-700 rounded-lg shadow-xl transform hover:scale-105 transition-all duration-300 ease-in-out border-4 border-green-500 hover:border-green-400"
                        >
                            <span className="text-6xl mb-4">üîç</span>
                            <span className="text-3xl font-bold">Seek</span>
                            <span className="text-lg text-gray-400 mt-2">Extract a message</span>
                        </button>
                    </div>
                </div>
            );
        }

        function HidePage({ setPage }) {
            const [message, setMessage] = useState('');
            const [imageFile, setImageFile] = useState(null);
            const [outputImage, setOutputImage] = useState(null);
            const [error, setError] = useState('');
            const canvasRef = useRef(null);
            const imgRef = useRef(new Image());

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setImageFile(file);
                    setError('');
                    setOutputImage(null);
                }
            };

            const handleHideMessage = async () => {
                setError('');
                setOutputImage(null);

                if (!imageFile) {
                    setError('Please upload an image first.');
                    return;
                }
                if (!message.trim()) {
                    setError('Please enter a message to hide.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (event) => {
                    imgRef.current.onload = () => {
                        const canvas = canvasRef.current;
                        canvas.width = imgRef.current.width;
                        canvas.height = imgRef.current.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(imgRef.current, 0, 0);

                        try {
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            const encodedImageData = encodeMessage(imageData, message);
                            ctx.putImageData(encodedImageData, 0, 0);
                            setOutputImage(canvas.toDataURL('image/png'));
                        } catch (err) {
                            setError(err.message);
                        }
                    };
                    imgRef.current.onerror = () => {
                        setError('Failed to load image. Please ensure it is a valid image file.');
                    };
                    imgRef.current.src = event.target.result;
                };
                reader.onerror = () => {
                    setError('Failed to read image file.');
                };
                reader.readAsDataURL(imageFile);
            };

            const downloadImage = () => {
                if (outputImage) {
                    const link = document.createElement('a');
                    link.href = outputImage;
                    link.download = 'steganized_image.png';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            };

            return (
                <div className="flex flex-col items-center justify-center flex-grow p-6 w-full max-w-2xl bg-gray-800 rounded-lg shadow-xl my-4">
                    <h2 className="text-3xl font-bold mb-6 text-blue-300">Hide Message in Image</h2>
                    <textarea
                        className="w-full p-3 mb-4 rounded-md bg-gray-700 text-gray-100 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        rows="4"
                        placeholder="Enter your secret message here..."
                        value={message}
                        onChange={(e) => setMessage(e.target.value)}
                    ></textarea>
                    <input
                        type="file"
                        accept="image/*"
                        onChange={handleImageUpload}
                        className="mb-6 w-full text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-500 file:text-white hover:file:bg-blue-600"
                    />

                    {error && <p className="text-red-400 mb-4">{error}</p>}

                    <button
                        onClick={handleHideMessage}
                        className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out mb-6"
                    >
                        Hide Message
                    </button>

                    {outputImage && (
                        <div className="mt-6 flex flex-col items-center">
                            <h3 className="text-xl font-semibold mb-3 text-green-300">Image with Hidden Message:</h3>
                            <img src={outputImage} alt="Steganized Output" className="max-w-full h-auto rounded-md shadow-md mb-4 border border-gray-700"/>
                            <button
                                onClick={downloadImage}
                                className="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white font-bold py-2 px-5 rounded-full shadow-md transform hover:scale-105 transition-all duration-300 ease-in-out"
                            >
                                Download Image
                            </button>
                        </div>
                    )}
                    <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>
                </div>
            );
        }

        function SeekPage({ setPage }) {
            const [imageFile, setImageFile] = useState(null);
            const [extractedMessage, setExtractedMessage] = useState('');
            const [error, setError] = useState('');
            const canvasRef = useRef(null);
            const imgRef = useRef(new Image());

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setImageFile(file);
                    setError('');
                    setExtractedMessage('');
                }
            };

            const handleSeekMessage = async () => {
                setError('');
                setExtractedMessage('');

                if (!imageFile) {
                    setError('Please upload an image first.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (event) => {
                    imgRef.current.onload = () => {
                        const canvas = canvasRef.current;
                        canvas.width = imgRef.current.width;
                        canvas.height = imgRef.current.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(imgRef.current, 0, 0);

                        try {
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            const message = decodeMessage(imageData);
                            setExtractedMessage(message);
                        } catch (err) {
                            setError(err.message);
                        }
                    };
                    imgRef.current.onerror = () => {
                        setError('Failed to load image. Please ensure it is a valid image file.');
                    };
                    imgRef.current.src = event.target.result;
                };
                reader.onerror = () => {
                    setError('Failed to read image file.');
                };
                reader.readAsDataURL(imageFile);
            };

            return (
                <div className="flex flex-col items-center justify-center flex-grow p-6 w-full max-w-2xl bg-gray-800 rounded-lg shadow-xl my-4">
                    <h2 className="text-3xl font-bold mb-6 text-blue-300">Seek Message from Image</h2>
                    <input
                        type="file"
                        accept="image/*"
                        onChange={handleImageUpload}
                        className="mb-6 w-full text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-500 file:text-white hover:file:bg-blue-600"
                    />

                    {error && <p className="text-red-400 mb-4">{error}</p>}

                    <button
                        onClick={handleSeekMessage}
                        className="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transform hover:scale-105 transition-all duration-300 ease-in-out mb-6"
                    >
                        Seek Message
                    </button>

                    {extractedMessage && (
                        <div className="mt-6 w-full">
                            <h3 className="text-xl font-semibold mb-3 text-purple-300">Extracted Message:</h3>
                            <div className="w-full p-4 bg-gray-700 text-gray-100 rounded-md border border-gray-600 break-words whitespace-pre-wrap">
                                {extractedMessage}
                            </div>
                        </div>
                    )}
                    <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>
                </div>
            );
        }

        function ContactPage() {
            return (
                <div className="flex flex-col items-center justify-center flex-grow p-6 w-full max-w-2xl bg-gray-800 rounded-lg shadow-xl my-4 text-center">
                    <h2 className="text-3xl font-bold mb-6 text-blue-300">Contact Us</h2>
                    <p className="text-lg text-gray-300 mb-4">
                        Have questions, feedback, or need support?
                    </p>
                    <p className="text-lg text-gray-300 mb-4">
                        Feel free to reach out to us at:
                    </p>
                    <p className="text-2xl font-semibold text-pink-400">
                        support@steganoweb.com
                    </p>
                    <p className="text-lg text-gray-400 mt-6">
                        We aim to respond to all inquiries within 24-48 hours.
                    </p>
                </div>
            );
        }

        function App() {
            const [page, setPage] = useState('home');

            let content;
            switch (page) {
                case 'home':
                    content = <HomePage setPage={setPage} />;
                    break;
                case 'hide-seek':
                    content = <HideSeekPage setPage={setPage} />;
                    break;
                case 'hide':
                    content = <HidePage setPage={setPage} />;
                    break;
                case 'seek':
                    content = <SeekPage setPage={setPage} />;
                    break;
                case 'contact':
                    content = <ContactPage />;
                    break;
                default:
                    content = <HomePage setPage={setPage} />;
            }

            return (
                <div className="min-h-screen bg-gray-900 text-gray-100 flex flex-col">
                    <Navbar setPage={setPage} />
                    <main className="flex-grow flex flex-col items-center justify-center p-4">
                        {content}
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>